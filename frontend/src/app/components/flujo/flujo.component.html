<div class="flujo-container">

  <!-- PASO 1: CLIENTE -->
  <section class="paso activo">
    <h3>1ï¸âƒ£ Selecciona un cliente</h3>

    <app-seleccion-cliente
      (seleccionar)="onClienteSeleccionado($event)">
    </app-seleccion-cliente>
  </section>

  <!-- PASO 2: PLANTILLAS -->
  <section class="paso"
           [class.bloqueado]="!cliente"
           [class.activo]="cliente && !plantilla">

    <h3>
      2ï¸âƒ£ Selecciona una plantilla
      <span *ngIf="!cliente" class="hint">
        (Primero selecciona un cliente)
      </span>
    </h3>

    <app-list-templates
      (plantilla)="onPlantillaSeleccionada($event)">
    </app-list-templates>
  </section>

  <!-- PASO 3: RESULTADO -->
    <div class="resultado" *ngIf="contenidoFinal">

    <div class="resultado-header">
        <h3>ğŸ“„ Vista final</h3>

        <button class="btn-reset" (click)="procesarContenido()">
            ğŸ”„ Restaurar
        </button>
    </div>

    <!-- CONTENIDO EDITABLE -->
    <textarea
        class="documento"
        [(ngModel)]="contenidoFinal"
        rows="12"
    ></textarea>

    <p class="resolucion" *ngIf="plantilla?.resolucion">
        <b>ResoluciÃ³n:</b> {{ plantilla.resolucion }}
    </p>

    </div>

    <div class="acciones">
      <button
        class="btn-guardar"
        (click)="guardarCambios()"
        [disabled]="guardando"
      >
        ğŸ’¾ {{ guardando ? 'Guardando...' : 'Guardar cambios' }}
      </button>

      <button class="btn-copiar" (click)="copiarContenido()">
        ğŸ“‹ Copiar
      </button>
    </div>
    <p class="mensaje-guardado" *ngIf="mensajeGuardado">
      {{ mensajeGuardado }}
    </p>

</div>
