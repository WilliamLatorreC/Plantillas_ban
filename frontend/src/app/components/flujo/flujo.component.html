<div class="flujo-container">

  <!-- PASO 1: CLIENTE -->
  <section class="paso activo">
    <h3>1ï¸âƒ£ Selecciona un cliente</h3>

    <app-seleccion-cliente
      (seleccionar)="onClienteSeleccionado($event)">
    </app-seleccion-cliente>
  </section>

  <!-- PASO 2: PLANTILLAS -->
  <section
    class="paso"
    [class.bloqueado]="!cliente"
    [class.activo]="cliente && !plantilla"
  >
    <h3>
      2ï¸âƒ£ Selecciona una plantilla
      <span *ngIf="!cliente" class="hint">
        (Primero selecciona un cliente)
      </span>
    </h3>

    <app-list-templates
      (plantilla)="onPlantillaSeleccionada($event)">
    </app-list-templates>
  </section>

  <!-- PASO 3: DATOS DE LA PLANTILLA -->
  <section class="paso activo" *ngIf="plantillaEditable">

    <h3>
      ğŸ§© Datos de la plantilla
      <span class="hint">Editable</span>
    </h3>

    <div class="form-grid">

      <div class="form-group">
        <label>Nombre de la plantilla</label>
        <input
          [(ngModel)]="plantillaEditable.nombre"
          (input)="onCambioPlantilla()"
        />
      </div>

      <div class="form-group">
        <label>Producto</label>
        <input
          [(ngModel)]="plantillaEditable.producto"
          (input)="onCambioPlantilla()"
        />
      </div>

    </div>

    <div class="form-group">
      <label>Contenido</label>
      <textarea readonly
        rows="6"
        [(ngModel)]="plantillaEditable.contenido"
        (input)="onCambioPlantilla()"
      ></textarea>
    </div>

    <div class="form-group">
      <label>ResoluciÃ³n</label>
      <textarea
        rows="4"
        [(ngModel)]="plantillaEditable.resolucion"
        (input)="onCambioPlantilla()"
      ></textarea>
    </div>

  </section>

  <!-- PASO 4: RESULTADO FINAL -->
  <section class="paso activo" *ngIf="contenidoFinal">

    <h3>
      ğŸ“„ Vista final
      <span class="hint">Editable</span>
    </h3>

    <div class="resultado">

      <div class="resultado-header">
        <strong>Documento generado</strong>

        <div class="acciones">
          <button class="btn-reset" (click)="procesarContenido()">
            ğŸ”„ Restaurar
          </button>

          <button
            class="btn-guardar"
            (click)="guardarCambios()"
            [disabled]="guardando"
          >
            ğŸ’¾ {{ guardando ? 'Guardando...' : 'Guardar cambios' }}
          </button>

          <button class="btn-copiar" (click)="copiarContenido()">
            ğŸ“‹ Copiar
          </button>
        </div>
      </div>

      <textarea
        class="documento"
        [(ngModel)]="contenidoFinal"
        rows="12"
      ></textarea>

      <p class="resolucion" *ngIf="plantillaEditable?.resolucion">
        ğŸ“Œ ResoluciÃ³n:
        <b>{{ plantillaEditable.resolucion }}</b>
      </p>

      <p class="mensaje-guardado" *ngIf="mensajeGuardado">
        {{ mensajeGuardado }}
      </p>

    </div>

  </section>

</div>
