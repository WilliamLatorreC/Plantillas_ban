<div class="templates-container">
  <!-- Panel izquierdo -->
  <section class="info-panel">
    <h2>📄 Plantillas disponibles</h2>
    <p class="subtitle">Selecciona un producto para ver sus plantillas.</p>

    <div class="search-box">
      <input type="text" [(ngModel)]="busqueda" placeholder="🔍 Buscar producto o plantilla..." (ngModelChange)="expandirProductosPorBusqueda()"/>
    </div>

    <div class="template-list">
      <div *ngFor="let prod of productos">
        <div 
          class="producto-card"
          [class.destacado-producto]="prod.toLowerCase().includes(busqueda.toLowerCase())"
          (click)="toggleProducto(prod)"
        >
          <strong>{{ prod }}</strong>
        </div>
        <div class="plantilla-sublist" *ngIf="productosAbiertos[prod]">
          <div
            class="template-card"
            *ngFor="let plantilla of getPlantillasPorProducto(prod)"
            (click)="seleccionarPlantilla(plantilla)"
            [innerHTML]="resaltarCoincidencias(plantilla.nombre)"
          >
            {{ plantilla.nombre }}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Panel derecho -->
  <section class="preview-panel" *ngIf="plantillaSeleccionada">
    <h2>👁️ Vista previa</h2>
    <div class="preview-content">
      <div class="form-group">
        <label>Nombre:</label>
        <input type="text" [(ngModel)]="nombre" />
      </div>
      <div class="form-group">
        <label>Producto:</label>
        <input type="text" [(ngModel)]="producto" />
      </div>
      <div class="form-group">
        <label>Contenido:</label>
        <textarea [(ngModel)]="plantillaGenerada"></textarea>
      </div>
    </div>

    <div class="actions">
      <button (click)="actualizarPlantilla()">✏️ Actualizar</button>
      <button (click)="eliminarPlantilla(plantillaSeleccionada._id)" class="delete">🗑️ Eliminar</button>
    </div>
  </section>

  <section class="empty-preview" *ngIf="!plantillaSeleccionada">
    <p>Selecciona una plantilla para verla aquí.</p>
  </section>
</div>
