<div class="contenedor-general">
  <!-- ğŸ“‹ Panel izquierdo -->
  <div class="panel-izquierdo">
    <h3>ğŸ“„ Plantillas disponibles</h3>

    <input
      type="text"
      [(ngModel)]="busqueda"
      (keyup)="filtrarPlantillas()"
      placeholder="ğŸ” Buscar producto o plantilla..."
      class="buscador"
    />

    <div *ngFor="let producto of productos">
      <div class="producto-titulo" (click)="toggleProducto(producto)">
        {{ producto }}
      </div>

      <div *ngIf="productosAbiertos[producto]" class="lista-plantillas">
        <div
          *ngFor="let plantilla of getPlantillasPorProducto(producto)"
          (click)="seleccionarPlantilla(plantilla)"
          [class.activa]="plantillaSeleccionada && plantillaSeleccionada._id === plantilla._id"
          class="item-plantilla">
          {{ plantilla.nombre }}
        </div>
      </div>
    </div>
  </div>

  <!-- ğŸ“‚ Panel derecho -->
<div class="panel-derecho">
  <div class="tabs">
    <button 
      [class.active]="tabActiva === 'vista'" 
      (click)="cambiarTab('vista')">
      ğŸ‘ï¸ Vista previa
    </button>
    <button 
      [class.active]="tabActiva === 'categorias'" 
      (click)="cambiarTab('categorias')">
      ğŸ—‚ï¸ CategorÃ­as
    </button>
  </div>

  <!-- ğŸ§© Vista previa -->
  <div *ngIf="tabActiva === 'vista'" class="vista-previa">

    <!-- Si NO hay plantilla seleccionada -->
    <div *ngIf="!plantillaSeleccionada" class="sin-plantilla">
      <p><strong>Seleccione una plantilla</strong> en el panel izquierdo para visualizarla o editarla.</p>
    </div>

    <!-- Si HAY plantilla seleccionada -->
    <div *ngIf="plantillaSeleccionada" class="contenedor-vista">
      <h3>Vista previa</h3>

      <label>Nombre:</label>
      <input type="text" [(ngModel)]="nombre" class="form-control" />

      <label>Producto:</label>
      <input type="text" [(ngModel)]="producto" class="form-control" />

      <label>Contenido:</label>
      <textarea rows="5" [(ngModel)]="plantillaGenerada" class="form-control"></textarea>

      <label>ResoluciÃ³n recomendada:</label>
      <textarea rows="3" [(ngModel)]="resolucion" class="form-control"></textarea>

      <div class="botones">
        <button (click)="actualizarPlantilla()" class="btn-azul">Actualizar</button>
        <button (click)="eliminarPlantilla(plantillaSeleccionada?._id)" class="btn-rojo" disabled>Eliminar</button>
      </div>
    </div>
  </div>

  <!-- ğŸ—‚ï¸ CategorÃ­as -->
  <div *ngIf="tabActiva === 'categorias'" class="vista-categorias">
    <h3>ğŸ—‚ï¸ CategorÃ­as disponibles</h3>
     <!-- Si NO hay plantilla seleccionada -->
    <div *ngIf="!plantillaSeleccionada" class="sin-categorias">
      <p><strong>No hay categorÃ­as registradas actualmente.</strong> Las categorÃ­as se crean automÃ¡ticamente al asociarlas con nuevas plantillas.</p>
    </div>

    <div *ngIf="plantillaSeleccionada && categoriasAsociadas.length === 0" class="sin-categorias">
    ğŸ“<strong>Esta plantilla no tiene categorÃ­as asociadas.</strong> Puedes crear una nueva categorÃ­a o vincularla desde el panel de gestiÃ³n.
    </div>

     <div *ngIf="categoriasAsociadas.length > 0">
      <div *ngFor="let cat of categoriasAsociadas" class="categoria-item">
        <h4>{{ cat.nombre }}</h4>
        <p>{{ cat.descripcion }}</p>
      </div>
    </div>
  </div>

</div>
